<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/utils/DOM_utils.js - Blanket</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="Blanket"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 2.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AdapterManager.html">AdapterManager</a></li>
            
                <li><a href="../classes/Blanket.html">Blanket</a></li>
            
                <li><a href="../classes/BrowserLoader.html">BrowserLoader</a></li>
            
                <li><a href="../classes/QUnitAdapter.html">QUnitAdapter</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Adapter manager.html">Adapter manager</a></li>
            
                <li><a href="../modules/Blanket Core.html">Blanket Core</a></li>
            
                <li><a href="../modules/Blanket Index.html">Blanket Index</a></li>
            
                <li><a href="../modules/Browser Loader.html">Browser Loader</a></li>
            
                <li><a href="../modules/Common Utils.html">Common Utils</a></li>
            
                <li><a href="../modules/DOM utils.html">DOM utils</a></li>
            
                <li><a href="../modules/QUnit Adapter.html">QUnit Adapter</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/utils/DOM_utils.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
* Blanket.js
* DOM Utils
* Version 2.0
*
* Utility functions for interacting with the DOM
* @module DOM utils
*/

(function(globalScope){
    
    /**
    * Load a url using a synchornous XHR
    *
    * @method loadFile
    * @param {String} path The path to the file (normally a URL)
    */
    function loadFile(path){
        if (typeof path !== &quot;undefined&quot;){
            var request = new XMLHttpRequest();
            request.open(&#x27;GET&#x27;, path, false);
            request.send();
            return request.responseText;
        }
    }

    /**
    * Attach a script element to the DOM
    * No data validation is done.  We assume the source passed is valid JavaScript
    *
    * @method addScript
    * @param {String} data The JavaScript to attach to the page
    */
    function addScript(data){
        Blanket.utils.debug(&quot;Adding script to DOM&quot;);
        var script = document.createElement(&quot;script&quot;);
        script.type = &quot;text/javascript&quot;;
        script.text = data;
        (document.body || document.getElementsByTagName(&#x27;head&#x27;)[0]).appendChild(script);
    }

    /**
    * Use the DOM to generate a complete URL
    *
    * @method qualifyURL
    * @param {String} url The URL to be &quot;qualified&quot;
    * @return {String} The qualified URL
    */
    function qualifyURL(url) {
        //http://stackoverflow.com/questions/470832/getting-an-absolute-url-from-a-relative-one-ie6-issue
        var a = document.createElement(&#x27;a&#x27;);
        a.href = url;
        return a.href;
    }

    /**
    * Parse Blanket related data-attributes from the DOM
    * Used to identfy Blanket options and identify the Blanket script reference
    *
    * @method parseDataAttributes
    * @return {Object} An object representing all the Blanket related data-attributes found in the DOM
    */
    function parseDataAttributes(){
        var blanketPrefix = &quot;data-blanket&quot;,
            blanketFlags = blanketPrefix+&quot;-flags&quot;,
            toArray =Array.prototype.slice, //http://stackoverflow.com/a/2954896
            scripts = toArray.call(document.scripts),
            blanketScript,
            attributes,
            dataAttributes={
                flags: {}
            },
            possibleBlanketScripts;

        //we need to find the blanket script.
        //we look for data-blanket
        possibleBlanketScripts = toArray.call(document.querySelectorAll(&quot;script[&quot;+blanketPrefix+&quot;]&quot;));

        if (possibleBlanketScripts.length === 0){
            Blanket.utils.debug(&quot;No blanket script detected, so no config options parsed.&quot;);
        }else{
            blanketScript = possibleBlanketScripts[0];
            attributes = blanketScript.attributes;
            toArray.call(attributes).forEach(function(s){
                if (s.nodeName.indexOf(blanketPrefix) === 0 &amp;&amp;
                    s.nodeName !== blanketPrefix){
                    if (s.nodeName === blanketFlags){
                        s.nodeValue.split(&quot; &quot;).forEach(function(flag){
                            dataAttributes[&quot;flags&quot;][flag]=true;
                        });
                    }else{
                        dataAttributes[s.nodeName.substring(blanketPrefix.length+1)] = s.nodeValue;
                    }
                }  
            });
        }
        return dataAttributes;
    }

    /**
    * Find all scripts tagged with the &#x60;data-blanket-cover&#x60; attribute
    *
    * @method parseCoveredFiles
    * @return {Array} An array containing all the HTML Script elements decorated with the &#x60;data-blanket-cover&#x60; attribute
    */
    function parseCoveredFiles(){
        var blanketPrefix = &quot;data-blanket&quot;,
            blanketToCover = blanketPrefix+&quot;-cover&quot;,
            toArray =Array.prototype.slice;
      
        return toArray.call(document.querySelectorAll(&quot;script[&quot;+blanketToCover+&quot;]&quot;));
    }

    /**
    * Get querystring parameters
    *
    * @method getParameterByName
    * @param {String} name The query string parameter to search for
    * @return {String} The value of the query string parameter
    */
    function getParameterByName(name) {
        //http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript
        name = name.replace(/[\[]/, &quot;\\[&quot;).replace(/[\]]/, &quot;\\]&quot;);
        var regex = new RegExp(&quot;[\\?&amp;]&quot; + name + &quot;=([^&amp;#]*)&quot;),
            results = regex.exec(location.search);
        return results == null ? &quot;&quot; : decodeURIComponent(results[1].replace(/\+/g, &quot; &quot;));
    }

    
    var exportables = {
        qualifyURL: qualifyURL,
        loadFile: loadFile,
        addScript: addScript,
        parseDataAttributes: parseDataAttributes,
        parseCoveredFiles: parseCoveredFiles,
        getParameterByName: getParameterByName
    };

    globalScope.Blanket.DOMUtils = exportables;
})(window);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
